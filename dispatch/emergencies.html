<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="../images/PULSE OG.png" type="image/png" />
  <title>PULSE ADMIN | Incidents Viewer</title>

  <!-- ========== All CSS files linkup ========= -->
  <link rel="stylesheet" href="../admin/assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="../admin/assets/css/lineicons.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="../admin/assets/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="../admin/assets/css/main.css" />
  <link rel="stylesheet" href="css/accessibility.css" />
  <style>
    /* Incidents Board Styling */
    .incident-banner {
      background: linear-gradient(135deg, #1a3a52 0%, #2d5f8d 100%);
      color: white;
      padding: 30px;
      border-radius: 12px;
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      gap: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .incident-icon {
      font-size: 48px;
    }
    .incident-content h2 {
      font-size: 28px;
      font-weight: 700;
      margin: 0 0 5px 0;
    }
    .incident-content p {
      margin: 0;
      opacity: 0.9;
    }
    .filter-badge {
      padding: 12px 28px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      background: #e0e0e0;
      color: #333;
    }
    .filter-badge:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .filter-badge.active {
      background: #c49536;
      color: white;
      transform: scale(1.05);
    }

    .entries-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }
    .entries-title {
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .entries-controls {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .entries-controls label {
      font-size: 14px;
      color: #666;
    }
    .entries-controls select {
      padding: 8px 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }
    .entries-controls input {
      padding: 8px 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      min-width: 200px;
    }
    .incidents-table {
      background: white;
      border-radius: 10px;
      overflow: hidden;
    }
    .incidents-table th {
      background: #f8f9fa;
      font-weight: 600;
      font-size: 12px;
      color: #666;
      text-transform: uppercase;
      padding: 15px 20px;
      border: none;
    }
    .incidents-table td {
      padding: 15px 20px;
      vertical-align: middle;
      border-bottom: 1px solid #f0f0f0;
      font-size: 14px;
    }
    .incidents-table tbody tr:nth-child(even) {
      background: #fdf5f5;
    }
    .incidents-table tbody tr:hover {
      background: #f0f7ff;
    }

    .priority-critical { background: #ffebee !important; border-left: 4px solid #dc3545; }
    .priority-high { background: #fff3e0 !important; border-left: 4px solid #ff9800; }
    .priority-medium { background: #e3f2fd !important; border-left: 4px solid #2196f3; }
    .priority-low { background: #f5f5f5 !important; border-left: 4px solid #9e9e9e; }
    .priority-badge { padding: 4px 12px; border-radius: 6px; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; }
    .priority-critical-badge { background: #dc3545; color: white; }
    .priority-high-badge { background: #ff9800; color: white; }
    .priority-medium-badge { background: #2196f3; color: white; }
    .priority-low-badge { background: #9e9e9e; color: white; }
    
    .status-new { background: #fee2e2; color: #dc2626; padding: 4px 10px; border-radius: 4px; font-weight: 600; }
    .status-dispatched { background: #fef3c7; color: #d97706; padding: 4px 10px; border-radius: 4px; font-weight: 600; }
    .status-enroute { background: #dbeafe; color: #2563eb; padding: 4px 10px; border-radius: 4px; font-weight: 600; }
    .status-resolved { background: #dcfce7; color: #16a34a; padding: 4px 10px; border-radius: 4px; font-weight: 600; }

    .category-medical { color: #e74c3c; }
    .category-fire { color: #f39c12; }
    .category-crime { color: #9b59b6; }
    .category-rescue { color: #1abc9c; }
    .category-disaster { color: #e84e89; }

    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.3s ease;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.show {
      display: flex;
      opacity: 1;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      max-width: 600px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 25px;
      border-bottom: 2px solid #f0f0f0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px 12px 0 0;
    }

    .modal-header h2 {
      margin: 0;
      font-size: 22px;
      font-weight: 700;
    }

    .modal-close {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      font-size: 32px;
      cursor: pointer;
      padding: 0;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    .modal-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    .modal-body {
      padding: 25px;
    }

    .detail-row {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #f0f0f0;
    }

    .detail-row .label {
      font-weight: 700;
      color: #555;
      min-width: 140px;
      font-size: 14px;
    }

    .detail-row .value {
      color: #333;
      font-size: 14px;
      word-break: break-word;
    }

    .switchable-section { display: none; }
    .switchable-section.active { display: block; animation: fadeIn .25s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

    .section-title {
      font-size: 24px;
      font-weight: 700;
      color: #333;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
  </style>
</head>
<body>
  <!-- ======== Preloader =========== -->
  <div id="preloader"><div class="spinner"></div></div>

  <!-- ======== sidebar-nav start =========== -->
  <aside class="sidebar-nav-wrapper">
    <div class="navbar-logo">
      <a href="index.html" style="display: flex; align-items: center; gap: 10px; text-decoration: none;">
        <img src="../images/PULSE OG.png" alt="logo" style="width: 45px; height: 45px; object-fit: contain;" />
        <span style="font-size: 18px; font-weight: 600; color: #3b5998;">PULSE Dispatch</span>
      </a>
    </div>
    <nav class="sidebar-nav">
      <ul>
        <li class="nav-item"><a href="index.html"><span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 13H10C10.55 13 11 12.55 11 12V4C11 3.45 10.55 3 10 3H4C3.45 3 3 3.45 3 4V12C3 12.55 3.45 13 4 13ZM4 21H10C10.55 21 11 20.55 11 20V16C11 15.45 10.55 15 10 15H4C3.45 15 3 3.45 3 16V20C3 20.55 3.45 21 4 21ZM14 21H20C20.55 21 21 20.55 21 20V12C21 11.45 20.55 11 20 11H14C13.45 11 13 11.45 13 12V20C13 20.55 13.45 21 14 21ZM13 4V8C13 8.55 13.45 9 14 9H20C20.55 9 21 8.55 21 8V4C21 3.45 20.55 3 20 3H14C13.45 3 13 3.45 13 4Z" fill="currentColor"/></svg></span><span class="text">Dashboard</span></a></li>
        <li class="nav-item active"><a href="emergencies.html"><span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" fill="currentColor"/></svg></span><span class="text">Emergencies</span></a></li>
        <li class="nav-item"><a href="dispatch.html"><span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm11 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM5 11l1.5-4.5h11L19 11H5z" fill="currentColor"/></svg></span><span class="text">Dispatch</span></a></li>
        <li class="nav-item"><a href="reports.html"><span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z" fill="currentColor"/></svg></span><span class="text">Reports</span></a></li>
        <li class="nav-item" style="margin-bottom: 15px;"><a href="news-events-view.html"><span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H20C21.1 21 22 20.1 22 19V5C22 3.9 21.1 3 20 3ZM5 7H10V13H5V7ZM19 17H5V15H19V17ZM19 13H12V11H19V13ZM19 9H12V7H19V9Z" fill="currentColor"/></svg></span><span class="text">News & Events</span></a></li>
      </ul>
    </nav>
  </aside>
  <div class="overlay"></div>

  <!-- ======== main-wrapper start =========== -->
  <main class="main-wrapper">
    <!-- ========== header start ========== -->
    <header class="header">
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-5 col-md-5 col-6">
            <div class="header-left d-flex align-items-center">
              <div class="menu-toggle-btn mr-15">
                <button id="menu-toggle" class="main-btn primary-btn btn-hover">
                  <i class="lni lni-chevron-left me-2"></i> Menu
                </button>
              </div>
            </div>
          </div>
          <div class="col-lg-7 col-md-7 col-6">
            <div class="header-right">
              <div class="profile-box ml-15">
                <button class="dropdown-toggle bg-transparent border-0" type="button" id="profile" data-bs-toggle="dropdown" aria-expanded="false">
                  <div class="profile-info">
                    <div class="info">
                      <div class="image"><img src="../admin/assets/images/profile/profile-image.png" alt="" /></div>
                      <div><h6 class="fw-500">Dispatch Officer</h6><p>Responder</p></div>
                    </div>
                  </div>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profile">
                  <li><a href="#0"><i class="lni lni-exit"></i> Sign Out</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- ========== section start ========== -->
    <section class="section">
      <div class="container-fluid">
        <!-- ========== title-wrapper start ========== -->
        <div class="title-wrapper pt-30">
          <div class="row align-items-center">
            <div class="col-md-6">
              <div class="title">
                <h2>üö® Active Incidents Board</h2>
                <p style="color: #666; font-size: 14px; margin-top: 5px;">Real-time dispatch incidents for San Juan CEDOC</p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="breadcrumb-wrapper">
                <nav aria-label="breadcrumb">
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Dashboard</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Emergencies</li>
                  </ol>
                </nav>
              </div>
            </div>
          </div>
        </div>

        <div class="filter-buttons" style="margin-bottom: 25px;">
          <button type="button" id="btnActive" class="filter-badge active">
            <i class="lni lni-check-circle"></i> Active Incidents
          </button>
          <button type="button" id="btnAll" class="filter-badge">
            <i class="lni lni-list"></i> All Incidents
          </button>
          <button type="button" id="btnResolved" class="filter-badge">
            <i class="lni lni-checkmark-circle"></i> Resolved
          </button>
        </div>

        <!-- Active Incidents Section -->
        <div id="incidents-section" class="card-style mb-30 switchable-section active">
          <h3 class="section-title" style="margin-bottom: 20px;">
            <i class="lni lni-alert"></i> Active Incidents
          </h3>

          <div class="entries-controls">
            <label>FILTER BY PRIORITY</label>
            <select id="priorityFilter">
              <option value="">All Priorities</option>
              <option value="High">High</option>
              <option value="Medium">Medium</option>
              <option value="Low">Low</option>
            </select>
            <label>SEARCH</label>
            <input type="text" id="incidentSearch" placeholder="Search by ID or location..." />
          </div>

          <div class="table-responsive">
            <table class="table incidents-table">
              <thead>
                <tr>
                  <th style="width: 10%;">INCIDENT ID</th>
                  <th style="width: 12%;">CATEGORY</th>
                  <th style="width: 20%;">LOCATION</th>
                  <th style="width: 12%;">PRIORITY</th>
                  <th style="width: 12%;">STATUS</th>
                  <th style="width: 15%;">REPORTED</th>
                  <th style="width: 10%;">REPORTER</th>
                  <th style="width: 9%;">ACTIONS</th>
                </tr>
              </thead>
              <tbody id="incidentsTableBody">
              </tbody>
            </table>
          </div>
        </div>

        <!-- All Incidents Section -->
        <div id="all-incidents-section" class="card-style mb-30 switchable-section">
          <h3 class="section-title" style="margin-bottom: 20px;">
            <i class="lni lni-folder-alt"></i> All Incidents
          </h3>

          <div class="entries-controls">
            <label>FILTER BY CATEGORY</label>
            <select id="categoryFilter2">
              <option value="">All Categories</option>
              <option value="Medical">Medical</option>
              <option value="Fire">Fire</option>
              <option value="Crime">Crime</option>
              <option value="Rescue">Rescue</option>
              <option value="Disaster">Disaster</option>
            </select>
            <label>SEARCH</label>
            <input type="text" id="incidentSearch2" placeholder="Search incidents..." />
          </div>

          <div class="table-responsive">
            <table class="table incidents-table">
              <thead>
                <tr>
                  <th style="width: 10%;">INCIDENT ID</th>
                  <th style="width: 12%;">CATEGORY</th>
                  <th style="width: 20%;">LOCATION</th>
                  <th style="width: 12%;">PRIORITY</th>
                  <th style="width: 12%;">STATUS</th>
                  <th style="width: 15%;">REPORTED</th>
                  <th style="width: 10%;">REPORTER</th>
                  <th style="width: 9%;">ACTIONS</th>
                </tr>
              </thead>
              <tbody id="allIncidentsTableBody">
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== footer start =========== -->
    <footer class="footer">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-6 order-last order-md-first">
            <div class="copyright text-center text-md-start">
              <p class="text-sm">PULSE Dispatch Center</p>
            </div>
          </div>
          <div class="col-md-6">
            <div class="terms d-flex justify-content-center justify-content-md-end">
              <a href="#0" class="text-sm">Privacy & Policy</a>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </main>

  <!-- Modal for incident details -->
  <div id="detailsModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">Incident Details</h2>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modalBody">
      </div>
    </div>
  </div>

  <script src="../admin/assets/js/bootstrap.bundle.min.js"></script>
  <script src="../admin/assets/js/main.js"></script>
  <script src="js/mock-data.js"></script>
  <script>
    // Mock incident data from dispatch.html
    const incidents = [
      { id:'INC-2026-0147', category:'Medical',  status:'New',        location:'Brgy. Greenhills, San Juan City',         reported:'2 mins ago',  priority:'High',   reporter:'Juan Dela Cruz' },
      { id:'INC-2026-0146', category:'Fire',     status:'Dispatched', location:'Brgy. Addition Hills, San Juan City',     reported:'8 mins ago',  priority:'High',   reporter:'Maria Santos' },
      { id:'INC-2026-0145', category:'Crime',    status:'En Route',   location:'Brgy. Batis, San Juan City',              reported:'15 mins ago', priority:'Medium', reporter:'Pedro Reyes' },
      { id:'INC-2026-0144', category:'Rescue',   status:'New',        location:'Brgy. Little Baguio, San Juan City',      reported:'23 mins ago', priority:'High',   reporter:'Ana Garcia' },
      { id:'INC-2026-0143', category:'Medical',  status:'Resolved',   location:'Brgy. Corazon de Jesus, San Juan City',   reported:'35 mins ago', priority:'Low',    reporter:'Carlos Mendoza' },
      { id:'INC-2026-0142', category:'Disaster', status:'New',        location:'Brgy. Ermita√±o, San Juan City',           reported:'45 mins ago', priority:'High',   reporter:'Rosa Aquino' },
      { id:'INC-2026-0141', category:'Fire',     status:'Dispatched', location:'Brgy. Isabelita, San Juan City',          reported:'52 mins ago', priority:'Medium', reporter:'Lito Ferrer' },
      { id:'INC-2026-0140', category:'Crime',    status:'New',        location:'Brgy. Kabayanan, San Juan City',          reported:'1 hour ago',  priority:'Medium', reporter:'Elena Cruz' }
    ];

    function getStatusClass(status) {
      const statusMap = {
        'New': 'status-new',
        'Dispatched': 'status-dispatched',
        'En Route': 'status-enroute',
        'Resolved': 'status-resolved'
      };
      return statusMap[status] || '';
    }

    function getPriorityClass(priority) {
      const priorityMap = {
        'High': 'priority-high',
        'Medium': 'priority-medium',
        'Low': 'priority-low'
      };
      return priorityMap[priority] || '';
    }

    function renderTable(incidents, tableBodyId) {
      const tbody = document.getElementById(tableBodyId);
      tbody.innerHTML = incidents.map(inc => `
        <tr class="${getPriorityClass(inc.priority)}">
          <td><strong>${inc.id}</strong></td>
          <td><span class="category-${inc.category.toLowerCase()}">${inc.category}</span></td>
          <td>${inc.location}</td>
          <td><span class="priority-badge priority-${inc.priority.toLowerCase()}-badge">${inc.priority}</span></td>
          <td><span class="${getStatusClass(inc.status)}">${inc.status}</span></td>
          <td>${inc.reported}</td>
          <td>${inc.reporter}</td>
          <td><button class="btn btn-sm btn-primary view-btn" onclick="viewDetails('${inc.id}')">View</button></td>
        </tr>
      `).join('');
    }

    function filterIncidents() {
      const priorityFilter = document.getElementById('priorityFilter').value;
      const searchText = document.getElementById('incidentSearch').value.toLowerCase();
      
      const active = incidents.filter(inc => inc.status !== 'Resolved');
      const filtered = active.filter(inc => {
        const matchPriority = !priorityFilter || inc.priority === priorityFilter;
        const matchSearch = !searchText || inc.id.toLowerCase().includes(searchText) || inc.location.toLowerCase().includes(searchText);
        return matchPriority && matchSearch;
      });
      
      renderTable(filtered, 'incidentsTableBody');
    }

    function filterAllIncidents() {
      const categoryFilter = document.getElementById('categoryFilter2').value;
      const searchText = document.getElementById('incidentSearch2').value.toLowerCase();
      
      const filtered = incidents.filter(inc => {
        const matchCategory = !categoryFilter || inc.category === categoryFilter;
        const matchSearch = !searchText || inc.id.toLowerCase().includes(searchText) || inc.location.toLowerCase().includes(searchText);
        return matchCategory && matchSearch;
      });
      
      renderTable(filtered, 'allIncidentsTableBody');
    }

    function viewDetails(id) {
      const incident = incidents.find(inc => inc.id === id);
      if (!incident) return;
      
      const modal = document.getElementById('detailsModal');
      document.getElementById('modalTitle').textContent = `${incident.category} Incident - ${incident.id}`;
      document.getElementById('modalBody').innerHTML = `
        <div class="detail-row">
          <span class="label">Category:</span>
          <span class="value category-${incident.category.toLowerCase()}">${incident.category}</span>
        </div>
        <div class="detail-row">
          <span class="label">Location:</span>
          <span class="value">${incident.location}</span>
        </div>
        <div class="detail-row">
          <span class="label">Priority:</span>
          <span class="value"><span class="priority-badge priority-${incident.priority.toLowerCase()}-badge">${incident.priority}</span></span>
        </div>
        <div class="detail-row">
          <span class="label">Status:</span>
          <span class="value"><span class="${getStatusClass(incident.status)}">${incident.status}</span></span>
        </div>
        <div class="detail-row">
          <span class="label">Reported:</span>
          <span class="value">${incident.reported}</span>
        </div>
        <div class="detail-row">
          <span class="label">Reporter:</span>
          <span class="value">${incident.reporter}</span>
        </div>
        <div style="display: flex; gap: 10px; margin-top: 20px; padding-top: 15px; border-top: 1px solid #f0f0f0;">
          <button class="btn btn-primary" onclick="locateIncident('${incident.id}')" style="flex: 1;">üìç Locate in Dispatch</button>
          <button class="btn btn-secondary" onclick="closeModal()" style="flex: 1;">Close</button>
        </div>
      `;
      modal.classList.add('show');
    }

    function locateIncident(id) {
      window.location.href = `dispatch.html?incident=${id}`;
    }

    function closeModal() {
      document.getElementById('detailsModal').classList.remove('show');
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      renderTable(incidents.filter(inc => inc.status !== 'Resolved'), 'incidentsTableBody');
      renderTable(incidents, 'allIncidentsTableBody');

      document.getElementById('priorityFilter').addEventListener('change', filterIncidents);
      document.getElementById('incidentSearch').addEventListener('keyup', filterIncidents);
      document.getElementById('categoryFilter2').addEventListener('change', filterAllIncidents);
      document.getElementById('incidentSearch2').addEventListener('keyup', filterAllIncidents);

      document.getElementById('btnActive').addEventListener('click', function() {
        document.querySelectorAll('.filter-badge').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        document.getElementById('incidents-section').classList.add('active');
        document.getElementById('all-incidents-section').classList.remove('active');
      });

      document.getElementById('btnAll').addEventListener('click', function() {
        document.querySelectorAll('.filter-badge').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        document.getElementById('incidents-section').classList.remove('active');
        document.getElementById('all-incidents-section').classList.add('active');
      });

      document.getElementById('btnResolved').addEventListener('click', function() {
        document.querySelectorAll('.filter-badge').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        const resolved = incidents.filter(inc => inc.status === 'Resolved');
        renderTable(resolved, 'allIncidentsTableBody');
        document.getElementById('incidents-section').classList.remove('active');
        document.getElementById('all-incidents-section').classList.add('active');
      });
    });

    // Menu toggle
    document.getElementById('menu-toggle')?.addEventListener('click', function() {
      document.querySelector('.sidebar-nav-wrapper').classList.toggle('show');
      document.querySelector('.overlay').classList.toggle('show');
    });
  </script>
  <script src="js/accessibility.js"></script>

  <!-- ========== Accessibility FAB ========== -->
  <button id="a11yFab" class="a11y-fab" title="Accessibility Settings" aria-label="Open Accessibility Settings">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="white"><path d="M12 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm9 7h-6l-1.41 7.06L16 22h-2.5l-1.5-5-1.5 5H8l2.41-5.94L9 9H3V7h18v2z"/></svg>
  </button>
  <div id="a11yOverlay" class="a11y-overlay"></div>
  <div id="a11yPanel" class="a11y-panel" role="dialog" aria-label="Accessibility Settings">
    <div class="a11y-panel-header"><h3><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm9 7h-6l-1.41 7.06L16 22h-2.5l-1.5-5-1.5 5H8l2.41-5.94L9 9H3V7h18v2z"/></svg> Accessibility Settings</h3><button id="a11yCloseBtn" class="a11y-close-btn" aria-label="Close">&times;</button></div>
    <div class="a11y-panel-body">
      <div class="a11y-section"><h4 class="a11y-section-title"><span class="a11y-icon purple"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5C10.55 5.4 8.45 5 6.5 5 5.33 5 4.11 5.15 3 5.5v14.07c0 .25.25.46.5.37C4.57 19.52 5.53 19.35 6.5 19.35c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5.97 0 1.93.09 2.88.36.23.07.62-.09.62-.36V5z"/></svg></span> Reading Assistance</h4>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Text-to-Speech</strong><small>Click any text to hear it read aloud</small></div><label class="a11y-switch"><input type="checkbox" id="a11yTTS"><span class="a11y-slider"></span></label></div>
        <button id="a11yReadPage" class="a11y-read-page-btn"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg> Read Page Aloud</button>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Dyslexia-Friendly Font</strong><small>Switch to OpenDyslexic typeface</small></div><label class="a11y-switch"><input type="checkbox" id="a11yDyslexia"><span class="a11y-slider"></span></label></div>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Text Size</strong><small>Adjust base text size</small></div><div class="a11y-range-wrap"><input type="range" id="a11yTextSize" class="a11y-range" min="80" max="200" step="10" value="100"><span id="a11yTextSizeVal" class="a11y-range-val">100%</span></div></div>
      </div>
      <div class="a11y-section"><h4 class="a11y-section-title"><span class="a11y-icon blue"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg></span> Visual Modes</h4>
        <div class="a11y-option"><div class="a11y-option-info"><strong>High Contrast</strong><small>Dark background with bright text</small></div><label class="a11y-switch"><input type="checkbox" id="a11yContrast"><span class="a11y-slider"></span></label></div>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Large UI Elements</strong><small>Bigger buttons, text, and spacing</small></div><label class="a11y-switch"><input type="checkbox" id="a11yLargeUI"><span class="a11y-slider"></span></label></div>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Simple Mode</strong><small>Hide charts and non-essential details</small></div><label class="a11y-switch"><input type="checkbox" id="a11ySimple"><span class="a11y-slider"></span></label></div>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Colorblind Palette</strong><small>Adjusted colors for color vision deficiency</small></div><label class="a11y-switch"><input type="checkbox" id="a11yColorblind"><span class="a11y-slider"></span></label></div>
      </div>
      <div class="a11y-section"><h4 class="a11y-section-title"><span class="a11y-icon amber"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg></span> Navigation & Feedback</h4>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Voice Guidance</strong><small>Announce navigation changes aloud</small></div><label class="a11y-switch"><input type="checkbox" id="a11yVoice"><span class="a11y-slider"></span></label></div>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Icon Labels</strong><small>Show text labels alongside icons</small></div><label class="a11y-switch"><input type="checkbox" id="a11yIconLabels"><span class="a11y-slider"></span></label></div>
        <div class="a11y-option"><div class="a11y-option-info"><strong>Confirmation Prompts</strong><small>Ask before critical actions</small></div><label class="a11y-switch"><input type="checkbox" id="a11yConfirm"><span class="a11y-slider"></span></label></div>
      </div>
      <div class="a11y-section"><h4 class="a11y-section-title"><span class="a11y-icon red"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg></span> Emergency</h4>
        <div class="a11y-option"><div class="a11y-option-info"><strong>One-Tap Emergency</strong><small>Show quick emergency shortcut button</small></div><label class="a11y-switch"><input type="checkbox" id="a11yEmergency"><span class="a11y-slider"></span></label></div>
        <button id="a11yEmergencyAction" class="a11y-emergency-btn" style="display:none;"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg> Send Emergency Alert</button>
      </div>
    </div>
    <div class="a11y-panel-footer"><button id="a11yResetBtn" class="a11y-reset-btn"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg> Reset All Settings</button></div>
  </div>
</body>
</html>
